{"version":3,"file":"component---src-pages-index-tsx-61da055edd636d9de9d8.js","mappings":"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","sources":["webpack://maeng-blog/./src/constants/meta.ts","webpack://maeng-blog/./src/utils/storage/core.ts","webpack://maeng-blog/./src/utils/storage/browser.ts","webpack://maeng-blog/./src/utils/storage/sessionStorage.ts","webpack://maeng-blog/./src/utils/storage/localStorage.ts","webpack://maeng-blog/./src/utils/storage/index.ts","webpack://maeng-blog/./src/hooks/useRenderedCount.ts","webpack://maeng-blog/./src/hooks/useScrollEvent.ts","webpack://maeng-blog/./src/pages/index.tsx","webpack://maeng-blog/./src/utils/event-manager.ts"],"sourcesContent":["export const HOME_TITLE = 'Home'\nexport const PORTFOLIO_TITLE = 'Portfolio'\n","const isEmpty = (storage: Storage) => {\n  return !storage || Object.keys(storage).length === 0\n}\n\nexport const getValueFrom = (storage: Storage, key: string) => {\n  if (isEmpty(storage)) {\n    return null\n  }\n  const rawData = storage.getItem(key)\n\n  if (!rawData) {\n    return null\n  }\n  return JSON.parse(rawData)\n}\n\nexport const setValueTo = (storage: Storage, key: string, data: any) => {\n  if (isEmpty(storage)) {\n    return null\n  }\n  return storage.setItem(key, JSON.stringify(data))\n}\n","export const localStorage = typeof window !== `undefined` ? window.localStorage : undefined\nexport const sessionStorage = typeof window !== `undefined` ? window.sessionStorage : undefined\n","import { partial } from 'maeng-utils/utils'\n\nimport { setValueTo, getValueFrom } from './core'\nimport { sessionStorage } from './browser'\n\nexport const setValueToSessionStorage = partial(setValueTo, sessionStorage!)\nexport const getValueFromSessionStorage = partial(getValueFrom, sessionStorage!)\n","import { partial } from 'maeng-utils/utils'\n\nimport { setValueTo, getValueFrom } from './core'\nimport { localStorage } from './browser'\n\nexport const setValueToLocalStorage = partial(setValueTo, localStorage!)\nexport const getValueFromLocalStorage = partial(getValueFrom, localStorage!)\n","import { getValueFromLocalStorage, setValueToLocalStorage } from './localStorage'\nimport { getValueFromSessionStorage, setValueToSessionStorage } from './sessionStorage'\n\nconst SESSION_STORAGE_KEY = '__maeng_blog_session_storage_key__'\nconst LOCAL_STORAGE_KEY = '__maeng_blog_local_storage_key__'\n\nexport const getCount = (defaultValue: number) => {\n  return getValueFromSessionStorage(`${SESSION_STORAGE_KEY}/count`) || defaultValue\n}\n\nexport const setCount = (val: number) => {\n  return setValueToSessionStorage(`${SESSION_STORAGE_KEY}/count`, val)\n}\n\nexport const getData = () => {\n  return getValueFromLocalStorage(LOCAL_STORAGE_KEY)\n}\n\nexport const setData = (val: string) => {\n  return setValueToLocalStorage(LOCAL_STORAGE_KEY, val)\n}\n\nexport const getTheme = (defaultValue: string) => {\n  return getValueFromLocalStorage(`${LOCAL_STORAGE_KEY}/theme`) || defaultValue\n}\n\nexport const setTheme = (val: string) => {\n  return setValueToLocalStorage(`${LOCAL_STORAGE_KEY}/theme`, val)\n}\n","import { useState, useEffect, useRef, useCallback } from 'react'\nimport * as Storage from '@/utils/storage'\n\nconst useRenderedCount = () => {\n  const initialCount = Storage.getCount(1)\n  const [count, setCount] = useState<number>(initialCount)\n  const countRef = useRef(count)\n  const increaseCount = useCallback(() => setCount((prev) => prev + 1), [])\n\n  useEffect(() => {\n    countRef.current = count\n    Storage.setCount(count)\n  }, [count])\n\n  return [count, countRef, increaseCount] as const\n}\n\nexport default useRenderedCount\n","import { useEffect } from 'react'\n\nconst useScrollEvent = (onScroll: (e: Event) => void) => {\n  useEffect(() => {\n    window.addEventListener(`scroll`, onScroll, { passive: false })\n    return () => {\n      window.removeEventListener(`scroll`, onScroll)\n    }\n  }, [])\n}\n\nexport default useScrollEvent\n","import { graphql, PageProps } from 'gatsby'\nimport { useCallback, useMemo } from 'react'\nimport { IGatsbyImageData } from 'gatsby-plugin-image'\nimport { Head, Category, PostList, Banner } from '@/components'\nimport { BASE_LINE, HOME_TITLE, INTERSECTION_OBSERVER_ROOT_MARGIN } from '@/constants'\nimport { toFit } from '@/utils/event-manager'\nimport useCategory from '@/hooks/useCategory'\nimport useIntersectionObserver from '@/hooks/useIntersectionObserver'\nimport useRenderedCount from '@/hooks/useRenderedCount'\nimport useScrollEvent from '@/hooks/useScrollEvent'\nimport { addClass, getDocumentHeight } from '@/utils/dom'\nimport { CategoryConst } from '@/types/Literal'\n\ninterface IndexPageDataProps {\n  site: {\n    siteMetadata: {\n      title: string\n      keywords: string[]\n      configs: {\n        countOfInitialPost: number\n      }\n    }\n  }\n  allMarkdownRemark: {\n    edges: {\n      node: {\n        frontmatter: {\n          date: string\n          title: string\n          category: string\n          draft: boolean\n          thumbnail?: {\n            childImageSharp: {\n              gatsbyImageData: IGatsbyImageData\n            }\n          }\n        }\n        excerpt: string\n        fields: {\n          slug: string\n        }\n      }\n    }[]\n  }\n}\n\nconst IndexPage = ({ data }: PageProps<IndexPageDataProps>) => {\n  const { siteMetadata } = data.site\n  const { countOfInitialPost } = siteMetadata.configs\n  const posts = data.allMarkdownRemark.edges\n  const [count, countRef, increaseCount] = useRenderedCount()\n  const [category, selectCategory] = useCategory()\n\n  const getDistance = useCallback((currentPos: number) => {\n    return getDocumentHeight() - currentPos\n  }, [])\n\n  useIntersectionObserver(\n    (entries: IntersectionObserverEntry[]) => {\n      return entries\n        .filter(({ isIntersecting }) => isIntersecting)\n        .forEach(({ target }) => addClass(target as HTMLElement, 'observed-shown'))\n    },\n    {\n      rootMargin: INTERSECTION_OBSERVER_ROOT_MARGIN,\n    },\n  )\n\n  useScrollEvent(() => {\n    const currentPos = window.scrollY + window.innerHeight\n    const isTriggerPos = () => getDistance(currentPos) < BASE_LINE\n    const doesNeedMore = () => posts.length > countRef.current * countOfInitialPost\n\n    return toFit(increaseCount, {\n      dismissCondition: () => !isTriggerPos(),\n      triggerCondition: () => isTriggerPos() && doesNeedMore(),\n    })()\n  })\n\n  const refinedPosts = useMemo(\n    () =>\n      posts\n        .filter(({ node }) => category === 'ALL' || node.frontmatter.category === category)\n        .slice(0, count * countOfInitialPost)\n        .map(({ node }) => ({\n          id: node.frontmatter.title,\n          title: node.frontmatter.title,\n          thumbnail: node.frontmatter.thumbnail?.childImageSharp.gatsbyImageData,\n          excerpt: node.excerpt,\n          slug: node.fields.slug,\n        })),\n    [category, count, countOfInitialPost, posts],\n  )\n\n  return (\n    <>\n      <Head title={HOME_TITLE} keywords={siteMetadata.keywords} />\n      <main>\n        <Banner />\n        <Category value={category} items={[...CategoryConst]} onClick={selectCategory} />\n        <PostList posts={refinedPosts} />\n      </main>\n    </>\n  )\n}\n\nexport const pageQuery = graphql`\n  query {\n    site {\n      siteMetadata {\n        title\n        configs {\n          countOfInitialPost\n        }\n      }\n    }\n    allMarkdownRemark(\n      sort: { fields: [frontmatter___date], order: DESC }\n      filter: { frontmatter: { category: { ne: null }, draft: { eq: false } } }\n    ) {\n      edges {\n        node {\n          excerpt(pruneLength: 280, truncate: true)\n          fields {\n            slug\n          }\n          frontmatter {\n            date(formatString: \"MMMM DD, YYYY\")\n            title\n            thumbnail {\n              childImageSharp {\n                gatsbyImageData\n              }\n            }\n            category\n            draft\n          }\n        }\n      }\n    }\n  }\n`\n\nexport default IndexPage\n","export const toFit = (\n  cb: Function,\n  { dismissCondition = () => false, triggerCondition = () => true },\n) => {\n  if (!cb) {\n    throw Error('Invalid required arguments')\n  }\n\n  let tick = false\n\n  return () => {\n    if (tick) {\n      return null\n    }\n\n    tick = true\n    return requestAnimationFrame(() => {\n      if (dismissCondition()) {\n        tick = false\n        return null\n      }\n\n      if (triggerCondition()) {\n        tick = false\n        return cb()\n      }\n      return null\n    })\n  }\n}\n"],"names":["HOME_TITLE","PORTFOLIO_TITLE","isEmpty","storage","Object","keys","length","getValueFrom","key","rawData","getItem","JSON","parse","setValueTo","data","setItem","stringify","localStorage","window","undefined","sessionStorage","setValueToSessionStorage","partial","getValueFromSessionStorage","SESSION_STORAGE_KEY","useRenderedCount","initialCount","defaultValue","count","setCount","useState","countRef","useRef","increaseCount","useCallback","prev","useEffect","current","onScroll","addEventListener","passive","removeEventListener","_ref","siteMetadata","site","countOfInitialPost","configs","posts","allMarkdownRemark","edges","category","selectCategory","useCategory","getDistance","currentPos","getDocumentHeight","useIntersectionObserver","entries","filter","_ref2","isIntersecting","forEach","_ref3","target","addClass","rootMargin","INTERSECTION_OBSERVER_ROOT_MARGIN","useScrollEvent","scrollY","innerHeight","isTriggerPos","BASE_LINE","toFit","dismissCondition","triggerCondition","refinedPosts","useMemo","_ref4","node","frontmatter","slice","map","_ref5","_node$frontmatter$thu","id","title","thumbnail","childImageSharp","gatsbyImageData","excerpt","slug","fields","_jsxs","_Fragment","children","_jsx","Head","keywords","Banner","Category","value","items","_toConsumableArray","CategoryConst","onClick","PostList","cb","Error","tick","requestAnimationFrame"],"sourceRoot":""}